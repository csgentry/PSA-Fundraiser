<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Who Has My Back?</title>
<meta name="description" content="Pick a jersey number (1–31) and donate that amount. 100% supports Premier Soccer Academy students.">

<!-- Typography -->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<link rel="icon" type="image/png" href="psa-logo.png">

<style>
  :root{
    --psa-blue:#003DA5; --psa-blue-2:#2857C5;
    --bg:#F6F8FC; --surface:#FFFFFF; --ink:#0F172A; --border:#E6EAF0; --taken:#EEF2F7;
    --shadow-lg:0 18px 40px rgba(15,23,42,.14);
    --radius:16px; --radius-pill:999px;
  }
  body{margin:0;background:var(--bg);color:var(--ink);
       font-family:'Inter',ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
       line-height:1.45;padding-bottom:96px}

  /* Hero gradient */
  .hero{background:linear-gradient(135deg,#003DA5 0%,#2857C5 70%);color:#fff;padding:28px 16px 20px;text-align:center}
  .crest{width:128px;margin:0 auto 10px;filter:drop-shadow(0 6px 14px rgba(0,0,0,.22))}
  h1{margin:6px 0;font-size:clamp(24px,5vw,40px)}
  .sub{color:#e6eefc;max-width:780px;margin:0 auto}

  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  .card{background:#fff;border:1px solid var(--border);border-radius:var(--radius);padding:22px;box-shadow:var(--shadow-lg);margin:18px 0}

  /* Progress */
  .progress{background:#cbd5e1;border-radius:12px;height:14px;overflow:hidden}
  .progress>div{height:100%;background:var(--psa-blue);width:0%;transition:width .3s}
  .progressMeta{display:flex;justify-content:space-between;font-size:13px;color:#475569;margin-top:8px}

  /* Grid */
  .legend{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:14px}
  .pill{background:#EEF2F7;border-radius:var(--radius-pill);padding:6px 12px;font-size:13px;color:#334155}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:18px;padding:10px 6px}

  /* Soccer-ball tiles */
  .tile{
    position:relative;aspect-ratio:1/1;border-radius:50%;border:2px solid #D7DEE8;
    background:radial-gradient(circle at 50% 50%, #FFFFFF 40%, #F0F4F8 100%);
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    cursor:pointer;transition:.18s;box-shadow:inset 0 8px 16px rgba(15,23,42,.06),0 3px 8px rgba(15,23,42,.05)
  }
  .tile:hover{transform:translateY(-2px)}
  .tile .num{font-weight:800;font-size:28px;color:var(--psa-blue)}
  .tile .amt{font-size:12px;color:#667085;margin-top:4px}
  .tile.selected{border-color:var(--psa-blue);background:radial-gradient(circle at 50% 50%,#fff 35%,#E7F0FF 100%)}

  /* TAKEN tiles: show only supporter name */
  .tile.taken{cursor:not-allowed;background:var(--taken);border-color:#D7DEE8;box-shadow:none;padding:12px}
  .tile.taken .name{
    font-weight:700;font-size:13px;color:#334155;line-height:1.15;text-align:center;padding:0 8px;word-break:break-word
  }
  .tile.taken .num, .tile.taken .amt{display:none}

  /* Sticky footer */
  .footerBar{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:3px solid var(--psa-blue);
             padding:16px;box-shadow:0 -8px 18px rgba(15,23,42,.06);z-index:5000}
  .barInner{max-width:1100px;margin:0 auto;display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .summary{color:#334155;font-size:15px}
  .btnPrimary{background:var(--psa-blue);color:#fff;border:none;border-radius:var(--radius-pill);padding:12px 20px;font-weight:800;cursor:pointer}
  .btnPrimary:disabled{opacity:.55;cursor:not-allowed}
  @media(max-width:600px){
    .summary{flex:1 1 100%;order:2}
    .btnPrimary{flex:1 1 100%;order:1;font-size:16px;padding:14px 18px}
  }

  /* Modal */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(15,23,42,.78);padding:20px;z-index:9999}
  .modal.open{display:flex}
  .sheet{background:#fff;width:min(560px,100%);border-radius:var(--radius);padding:22px}
  .payrow{display:grid;gap:12px}
  .btn{display:flex;justify-content:center;border-radius:var(--radius-pill);padding:12px;font-weight:800;text-decoration:none}
  .btn.applecash{background:#111827;color:#fff}
  .btn.venmo{background:#008cff;color:#fff}
  .btn.paypal{background:#ffc439;color:#111827}
  .btn.cashapp{background:#00c244;color:#fff}
  .small{font-size:12px;color:#64748b}
</style>
</head>
<body>
<div class="hero">
  <img src="psa-logo.png" alt="PSA crest" class="crest">
  <h1>Who Has My Back?</h1>
  <p class="sub">Pick a jersey number (1–31) and donate that amount. 100% supports classroom supplies, scholarships, and student projects.</p>
</div>

<div class="wrap">
  <!-- PROGRESS CARD -->
  <section class="card">
    <strong>Fundraiser Progress</strong>
    <div class="progress"><div id="bar"></div></div>
    <div class="progressMeta">
      <div id="raisedLabel">$0 raised</div>
      <div id="goalLabel">Goal: $496</div>
    </div>
  </section>

  <!-- GRID -->
  <section class="card">
    <div class="legend">
      <span class="pill">Tap to select multiple numbers</span>
      <span class="pill">Taken jerseys show the supporter’s name</span>
    </div>
    <div id="grid" class="grid" role="list"></div>
  </section>
</div>

<!-- STICKY CTA -->
<div class="footerBar" role="region" aria-live="polite">
  <div class="barInner">
    <div class="summary"><span id="count">0</span> selected · Total <strong id="total">$0</strong></div>
    <button id="payBtn" class="btnPrimary" disabled>Pay Selected</button>
  </div>
</div>

<!-- MODAL -->
<div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
  <div class="sheet">
    <h3 id="modalTitle">Complete Your Donation</h3>
    <p>You're donating for jersey number(s): <strong id="nums"></strong></p>
    <p>Total amount: <strong id="amtShow">$0</strong></p>

    <div class="payrow" style="margin-top:10px">
      <a id="payAppleCash" class="btn applecash" target="_blank" rel="noopener">Text to Pay (Apple Cash)</a>
      <a id="payVenmo" class="btn venmo" target="_blank" rel="noopener">Pay with Venmo</a>
      <a id="payPayPal" class="btn paypal" target="_blank" rel="noopener">Pay with PayPal</a>
      <a id="payCashApp" class="btn cashapp" target="_blank" rel="noopener">Pay with Cash App</a>
    </div>

    <p class="small" style="margin-top:8px">
      Apple Cash opens a text to 317-507-7258 with your numbers and total pre-filled.
      If a number is double-selected, the first completed payment wins.
    </p>
  </div>
</div>

<script>
  // ===== CONFIG =====
  const CONFIG = {
    venmoUser: "Csgentry",
    paypalMe:  "CodyGentry",
    cashTag:   "CGentry212",
    appleCashPhone: "13175077258",
    goal: 496,
    // Taken entries now include supporter names; these render name-only on the tile.
    taken: [
      { num: 20, name: "Carla & Paul Utley" },
      { num: 30, name: "Carla & Paul Utley" }
    ]
  };

  function sum(arr){ return arr.reduce((s,x)=>s+x,0); }

  // Build data helpers
  const takenMap = new Map(CONFIG.taken.map(t => [t.num, t.name]));
  const takenNums = CONFIG.taken.map(t => t.num);

  // Build grid
  const grid = document.getElementById("grid");
  const selected = new Set();

  for (let n=1; n<=31; n++){
    const tile = document.createElement("button");
    tile.className = "tile";
    tile.setAttribute("role","listitem");
    tile.setAttribute("aria-pressed","false");

    // Available tile content
    tile.innerHTML = `<div class="num">${n}</div><div class="amt">$${n}</div>`;

    if (takenMap.has(n)){
      // TAKEN: show only supporter name
      tile.classList.add("taken");
      tile.disabled = true;
      tile.setAttribute("aria-disabled","true");
      tile.innerHTML = `<div class="name">${takenMap.get(n)}</div>`;
    } else {
      tile.addEventListener("click", ()=>{
        if (selected.has(n)){ selected.delete(n); tile.classList.remove("selected"); tile.setAttribute("aria-pressed","false"); }
        else { selected.add(n); tile.classList.add("selected"); tile.setAttribute("aria-pressed","true"); }
        render();
      });
    }
    grid.appendChild(tile);
  }

  // Sticky CTA + Modal behavior
  const modal = document.getElementById("modal");
  const bodyEl = document.body;
  const payBtn = document.getElementById("payBtn");

  payBtn.addEventListener("click", ()=>{
    if (selected.size>0){
      modal.classList.add("open");
      bodyEl.classList.add("modal-open");
    }
  });
  modal.addEventListener("click", (e)=>{ if(e.target===modal){ modal.classList.remove("open"); bodyEl.classList.remove("modal-open"); } });

  function render(){
    const picks = Array.from(selected).sort((a,b)=>a-b);
    const total = sum(picks);
    document.getElementById("count").textContent = picks.length;
    document.getElementById("total").textContent = `$${total}`;
    payBtn.textContent = picks.length ? `Pay for Selected ($${total})` : `Pay Selected`;
    payBtn.disabled = picks.length===0;

    // Modal info
    document.getElementById("nums").textContent = picks.join(", ");
    document.getElementById("amtShow").textContent = `$${total}`;

    // Payment links
    buildAppleCashLink(picks, total);
    buildOtherLinks(total, picks);

    // Progress
    renderProgress();
  }

  // Progress bar from taken numbers
  function renderProgress(){
    const raised = takenNums.reduce((acc,n)=>acc+n,0);
    const pct = Math.max(0, Math.min(100, (raised/CONFIG.goal)*100));
    document.getElementById("bar").style.width = pct + "%";
    document.getElementById("raisedLabel").textContent = `$${raised} raised`;
    document.getElementById("goalLabel").textContent = `Goal: $${CONFIG.goal}`;
  }

  // Apple Cash text
  function buildAppleCashLink(arr, total){
    const phone = CONFIG.appleCashPhone;
    const bodyText = `PSA Fundraiser - I would like to pay for jerseys ${arr.join(', ')}. Total $${total}.`;
    const body = encodeURIComponent(bodyText);
    const isiOS = /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent);
    const href = isiOS ? `sms:${phone}&body=${body}` : `sms:${phone}?body=${body}`;
    document.getElementById("payAppleCash").href = href;
  }

  // Venmo / PayPal / Cash App
  function buildOtherLinks(total, arr){
    const numbersDisplay = arr.join(", ");
    const venNote = encodeURIComponent(`PSA Fundraiser - Jerseys ${numbersDisplay}`);
    const venName = CONFIG.venmoUser;

    const venApp = `venmo://paycharge?txn=pay&recipients=${encodeURIComponent(venName)}&amount=${total}&note=${venNote}`;
    const venWeb = `https://venmo.com/${encodeURIComponent(venName)}?txn=pay&amount=${total}&note=${venNote}`;
    const venBtn = document.getElementById("payVenmo");
    venBtn.href = venApp;
    venBtn.onclick = function(){ setTimeout(()=>{ window.open(venWeb,"_blank","noopener"); }, 250); };

    document.getElementById("payPayPal").href = `https://www.paypal.me/${encodeURIComponent(CONFIG.paypalMe)}/${total}`;
    document.getElementById("payCashApp").href = `https://cash.app/$${encodeURIComponent(CONFIG.cashTag)}/${total}`;
  }

  // Initial render
  render();
</script>
</body>
</html>
