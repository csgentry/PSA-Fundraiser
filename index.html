<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Who Has My Back? — PSA Fundraiser</title>
<meta name="description" content="Pick one or more jersey numbers (1–31) and donate the total. Supports classroom supplies, scholarships, and student-led projects at Premier Soccer Academy.">
<style>
  :root{
    --psa-blue:#003DA5;
    --psa-gray:#7D7D7D;
    --bg:#f7f9fb;
    --surface:#ffffff;
    --ink:#0f172a;
    --muted:#5b677a;
    --border:#e6eaf0;
    --accent:var(--psa-blue);
    --taken:#eaeef4;
    --shadow:0 10px 24px rgba(15,23,42,.08);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji;line-height:1.45}

  header{text-align:center;padding:20px 16px 10px}
  .crest{width:120px;height:auto;display:block;margin:0 auto 8px;filter:drop-shadow(0 6px 14px rgba(0,0,0,.08))}
  h1{margin:6px 0 6px;font-size:clamp(24px,5vw,38px);letter-spacing:.2px}
  .sub{margin:0 auto;color:var(--muted);max-width:780px;font-size:clamp(14px,2.8vw,16px)}

  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  .card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:18px;box-shadow:var(--shadow);margin-bottom:16px}

  /* Progress */
  .progressRow{display:grid;grid-template-columns:1fr;gap:8px;margin:4px 0 0}
  .progress{background:#eef2f7;border-radius:12px;overflow:hidden;position:relative;height:14px}
  .progress > div{height:100%;background:var(--psa-blue);width:0%;transition:width .3s ease}
  .progressMeta{display:flex;justify-content:space-between;font-size:13px;color:#475569}

  /* Grid */
  .legend{display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap;margin-bottom:14px}
  .pill{background:#eef2f7;border-radius:999px;padding:6px 12px;font-size:13px;color:#334155}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(90px,1fr));gap:16px;padding:10px 6px}

  /* Soccer-ball style circular tiles */
  .tile{width:100%;aspect-ratio:1/1;border-radius:50%;border:2px solid #d7dee8;
    background:radial-gradient(circle at 50% 50%,#ffffff 40%,#f0f4f8 100%);
    position:relative;cursor:pointer;transition:.2s ease;display:flex;align-items:center;justify-content:center;
    box-shadow:inset 0 8px 16px rgba(15,23,42,.06),0 3px 8px rgba(15,23,42,.05)}
  .tile:hover{transform:translateY(-2px)}
  .tile .num{font-weight:800;font-size:28px;z-index:2}
  .tile .amt{position:absolute;bottom:8px;font-size:12px;color:#667085}
  .tile::before,.tile::after{content:"";position:absolute;inset:10%;border-radius:50%;
    background:radial-gradient(circle at 50% 30%,rgba(0,0,0,.08),transparent 45%),
               radial-gradient(circle at 70% 70%,rgba(0,0,0,.06),transparent 40%);opacity:.35;pointer-events:none}
  .tile.selected{border-color:var(--accent);box-shadow:inset 0 0 0 3px rgba(0,61,165,.25),0 8px 20px rgba(15,23,42,.10);
    background:radial-gradient(circle at 50% 50%,#ffffff 35%,#e7f0ff 100%)}
  .tile.disabled{cursor:not-allowed;background:var(--taken);color:#94a3b8;border-color:#d7dee8;box-shadow:none}
  .tile.disabled .amt{color:#94a3b8}

  .cta{margin:8px 0 0;text-align:center;font-size:14px;color:#64748b}

  /* Sticky footer bar */
  .footerBar{position:sticky;bottom:0;left:0;right:0;background:rgba(255,255,255,.96);backdrop-filter:saturate(180%) blur(8px);
    border-top:2px solid var(--psa-blue);padding:10px 14px;box-shadow:0 -8px 18px rgba(15,23,42,.05)}
  .barInner{max-width:1100px;margin:0 auto;display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .summary{color:#334155;font-size:14px}
  .summary strong{font-size:16px}
  .btnPrimary{background:var(--psa-blue);color:#fff;border:none;border-radius:12px;padding:10px 16px;font-weight:700;cursor:pointer;
    box-shadow:0 6px 14px rgba(0,61,165,.35)}
  .btnPrimary:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}
  .taglist{display:inline-flex;gap:6px;flex-wrap:wrap;margin-left:8px;vertical-align:middle}
  .tag{background:#eef2f7;color:#334155;padding:4px 8px;border-radius:999px;font-size:12px}

  /* Modal */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(15,23,42,.45);padding:20px}
  .modal.open{display:flex}
  .sheet{background:#fff;width:min(560px,100%);border-radius:16px;padding:20px;box-shadow:0 14px 36px rgba(15,23,42,.25)}
  .sheet h3{margin:6px 0 6px}
  .sheet p{margin:4px 0 14px;color:#475569}
  .payrow{display:grid;grid-template-columns:1fr;gap:10px}
  .btn{display:flex;align-items:center;justify-content:center;gap:10px;border-radius:12px;padding:12px;font-weight:700;text-decoration:none;border:1px solid var(--border)}
  .btn.stripe{background:#111827;color:#fff}
  .btn.venmo{background:#008cff;color:#fff}
  .btn.paypal{background:#ffc439;color:#111827}
  .btn.cashapp{background:#00c244;color:#fff}
  .close{display:inline-block;margin-top:12px;color:#64748b;cursor:pointer}
  .small{font-size:12px;color:#64748b}

  /* Supporters wall */
  .wall{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
  .supporter{background:#fff;border:1px solid var(--border);border-radius:12px;padding:12px}
  .supporter .name{font-weight:700}
  .muted{color:#64748b;font-size:13px}
</style>
</head>
<body>
<header>
  <img src="images/psa-logo.png" alt="Premier Soccer Academy crest" class="crest">
  <h1>Who Has My Back?</h1>
  <p class="sub">Pick one or more jersey numbers (1–31) and donate the total. 100% of proceeds support classroom supplies, scholarships, and student-led projects.</p>
</header>

<div class="wrap">
  <!-- Progress -->
  <section class="card" id="progressCard">
    <strong>Fundraiser Progress</strong>
    <div class="progressRow">
      <div class="progress" aria-label="Progress toward goal $496">
        <div id="bar"></div>
      </div>
      <div class="progressMeta">
        <div id="raisedLabel">$0 raised</div>
        <div id="goalLabel">Goal: $496</div>
      </div>
    </div>
  </section>

  <!-- Number grid -->
  <section class="card">
    <div class="legend">
      <span class="pill">Tap to select multiple numbers</span>
      <span class="pill">Numbers gray out when taken</span>
    </div>
    <div id="grid" class="grid" role="list"></div>
    <div class="cta">Questions? Email <a href="mailto:csgentry@outlook.com">csgentry@outlook.com</a></div>
  </section>

  <!-- Supporters wall -->
  <section class="card">
    <strong>Supporters Wall</strong>
    <div id="wall" class="wall" style="margin-top:10px"></div>
    <div id="noSupporters" class="muted" style="margin-top:8px;display:none">Be the first to donate and claim a jersey number!</div>
  </section>
</div>

<!-- Sticky footer -->
<div class="footerBar" role="region" aria-live="polite">
  <div class="barInner">
    <div class="summary">
      <span id="count">0</span> selected · Total <strong id="total">$0</strong>
      <span id="chosen" class="taglist"></span>
    </div>
    <button id="payBtn" class="btnPrimary" disabled>Pay Selected</button>
  </div>
</div>

<!-- Modal -->
<div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
  <div class="sheet">
    <h3 id="modalTitle">Complete Your Donation</h3>
    <p>You're donating for jersey number(s): <strong id="nums"></strong></p>
    <p>Jersey total: <strong id="amtShow">$0</strong><br>
       With fees (Stripe): <strong id="amtWithFees">$0</strong></p>

    <div class="payrow" style="margin-top:10px">
      <a id="payStripe" class="btn stripe" target="_blank" rel="noopener">Pay with Apple Pay / Card</a>
      <a id="payVenmo" class="btn venmo" target="_blank" rel="noopener">Pay with Venmo</a>
      <a id="payPayPal" class="btn paypal" target="_blank" rel="noopener">Pay with PayPal</a>
      <a id="payCashApp" class="btn cashapp" target="_blank" rel="noopener">Pay with Cash App</a>
    </div>
    <div class="small" style="margin-top:10px">
      Notes include “PSA Fundraiser — Jerseys #X, #Y”. If a number is double-selected, first completed payment wins.
    </div>
    <span class="close" id="closeBtn" role="button" tabindex="0">Close</span>
  </div>
</div>

<script>
  // ===== CONFIG =====
  const CONFIG = {
    contactEmail: "csgentry@outlook.com",
    venmoUser: "Csgentry",        // Venmo username without @
    paypalMe:  "CodyGentry",      // PayPal.me handle without @
    cashTag:   "CGentry212",      // Cash App cashtag without $
    stripePaymentLink: "https://buy.stripe.com/8x29AL9xW2rM5Hc1Dx9Zm00", // your live link
    feePassThrough: true,         // donor covers Stripe fee on Stripe button
    goal: 496,                    // 1..31 summed
    takenNumbers: [],             // e.g., [7, 12, 21]
    // Supporters list (optional). Each item: { name: "The Smith Family", numbers: [12,5], message: "Go PSA!" }
    supporters: [
      // Example:
      // { name: "The Smith Family", numbers: [12], message: "Go PSA!" }
    ]
  };

  // ===== Helpers =====
  function grossUp(amount) {
    if (!CONFIG.feePassThrough) return amount;
    return Math.round(((amount + 0.30) / 0.971) * 100) / 100; // 2.9% + $0.30
  }
  function sum(arr){ return arr.reduce((s,x)=>s+x,0); }

  // ===== Build grid =====
  const selected = new Set();
  const grid = document.getElementById("grid");

  // Build a Set of taken numbers from config.supporters + takenNumbers
  const takenSet = new Set(CONFIG.takenNumbers);
  CONFIG.supporters.forEach(s => (s.numbers||[]).forEach(n => takenSet.add(n)));

  for (let n=1;n<=31;n++){
    const tile = document.createElement("button");
    tile.className = "tile";
    tile.setAttribute("role","listitem");
    tile.setAttribute("aria-label", "Toggle jersey number " + n + " ($" + n + ")");
    tile.innerHTML = `<div class="num">${n}</div><div class="amt">$${n}</div>`;

    if (takenSet.has(n)){
      tile.classList.add("disabled"); tile.disabled = true; tile.title = "Taken"; tile.setAttribute("aria-disabled","true");
    } else {
      tile.addEventListener("click", ()=>toggle(n, tile));
      tile.addEventListener("keyup", (e)=>{ if(e.key==="Enter") toggle(n, tile); });
    }
    grid.appendChild(tile);
  }

  function toggle(n, el){
    if (selected.has(n)){ selected.delete(n); el.classList.remove("selected"); }
    else { selected.add(n); el.classList.add("selected"); }
    renderBar();
  }

  // ===== Sticky bar + modal links =====
  function renderBar(){
    const arr = Array.from(selected).sort((a,b)=>a-b);
    const total = sum(arr);
    document.getElementById("count").textContent = arr.length;
    document.getElementById("total").textContent = `$${total}`;

    const chosen = document.getElementById("chosen");
    chosen.innerHTML = "";
    arr.forEach(n=>{ const span=document.createElement("span"); span.className="tag"; span.textContent=`#${n}`; chosen.appendChild(span); });

    document.getElementById("payBtn").disabled = arr.length===0;

    // For modal
    document.getElementById("nums").textContent = arr.map(n=>`#${n}`).join(", ");
    document.getElementById("amtShow").textContent = `$${total}`;
    const withFees = grossUp(total);
    document.getElementById("amtWithFees").textContent = `$${withFees.toFixed(2)}`;

    buildStripeLink(total, arr);
    buildOtherLinks(total, arr);
  }

  function buildStripeLink(total, arr){
    const btn = document.getElementById("payStripe");
    const link = CONFIG.stripePaymentLink;
    if (!link){ btn.style.display="none"; return; }
    const charge = grossUp(total);
    const cents = Math.round(charge * 100);
    // Many donation links accept ?amount= (cents). If not, supporter can enter the amount on the Stripe page.
    btn.href = `${link}?amount=${cents}`;
    btn.textContent = `Pay $${charge.toFixed(2)} (Apple Pay / Card)`;
  }

  function buildOtherLinks(total, arr){
    const note = encodeURIComponent("PSA Fundraiser — Jerseys " + arr.map(n=>"#"+n).join(", "));
    // Venmo
    const venName = CONFIG.venmoUser;
    const venApp = `venmo://paycharge?txn=pay&recipients=${encodeURIComponent(venName)}&amount=${total}&note=${note}`;
    const venWeb = `https://venmo.com/${encodeURIComponent(venName)}?txn=pay&amount=${total}&note=${note}`;
    const venBtn = document.getElementById("payVenmo");
    venBtn.href = venApp;
    venBtn.onclick = function(){ setTimeout(()=>{ window.open(venWeb,"_blank","noopener"); }, 250); };

    // PayPal.me
    const pp = CONFIG.paypalMe;
    document.getElementById("payPayPal").href = `https://www.paypal.me/${encodeURIComponent(pp)}/${total}?note=${note}`;

    // Cash App
    const cash = CONFIG.cashTag;
    document.getElementById("payCashApp").href = `https://cash.app/$${encodeURIComponent(cash)}/${total}`;
  }

  // Modal controls
  const modal = document.getElementById("modal");
  document.getElementById("payBtn").addEventListener("click", ()=>{ if(selected.size>0){ modal.classList.add("open"); } });
  document.getElementById("closeBtn").addEventListener("click", ()=>modal.classList.remove("open"));
  modal.addEventListener("click", (e)=>{ if(e.target===modal){ modal.classList.remove("open"); } });

  // ===== Progress & Supporters Wall =====
  function renderProgressAndWall(){
    // Total raised = sum of jersey numbers from supporters (not grossed-up fees)
    const raised = CONFIG.supporters.reduce((acc, s)=> acc + sum(s.numbers||[]), 0);
    const pct = Math.max(0, Math.min(100, (raised/CONFIG.goal)*100));
    document.getElementById("bar").style.width = pct + "%";
    document.getElementById("raisedLabel").textContent = `$${raised} raised`;
    document.getElementById("goalLabel").textContent = `Goal: $${CONFIG.goal}`;

    // Wall
    const wall = document.getElementById("wall");
    wall.innerHTML = "";
    if (!CONFIG.supporters.length){
      document.getElementById("noSupporters").style.display = "block";
    } else {
      document.getElementById("noSupporters").style.display = "none";
      CONFIG.supporters.forEach(s=>{
        const card = document.createElement("div");
        card.className = "supporter";
        card.innerHTML = `
          <div class="name">${s.name || "Anonymous"}</div>
          <div class="muted">Jerseys: ${(s.numbers||[]).map(n=>"#"+n).join(", ") || "-"}</div>
          ${s.message ? `<div class="muted" style="margin-top:6px">“${s.message}”</div>` : ""}
        `;
        wall.appendChild(card);
      });
    }
  }

  // Init
  renderBar();
  renderProgressAndWall();
</script>
</body>
</html>
